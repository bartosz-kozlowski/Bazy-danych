1.

INSERT INTO PRACOWNICY
VALUES (250, 'KOWALSKI', 'ASYSTENT', NULL, TO_DATE('2015-01-13', 'yyyy-mm-dd'), 1500, NULL, 10);

INSERT INTO PRACOWNICY
VALUES (260, 'ADAMSKI', 'ASYSTENT', null, TO_DATE('2014-09-10', 'yyyy-mm-dd'), 1500, null, 10);

INSERT INTO PRACOWNICY
VALUES (270, 'NOWAK', 'ADIUNKT', null, TO_DATE('1990-05-01', 'yyyy-mm-dd'), 2050, 540, 20);

SELECT * FROM PRACOWNICY WHERE ID_PRAC = 250 or ID_PRAC = 260 or ID_PRAC = 270;

2.

UPDATE PRACOWNICY
SET PLACA_POD = PLACA_POD * 1.1, PLACA_DOD =
CASE
WHEN PLACA_DOD IS NULL THEN 100
WHEN PLACA_DOD IS NOT NULL THEN PLACA_DOD * 1.2
END
WHERE ID_PRAC = 250 OR ID_PRAC = 260 OR ID_PRAC = 270;

SELECT * FROM PRACOWNICY WHERE ID_PRAC = 250 or ID_PRAC = 260 or ID_PRAC = 270;

3.

INSERT INTO ZESPOLY
VALUES (60, 'BAZY DANYCH', 'PIOTROWO 2');

SELECT * FROM ZESPOLY
WHERE ID_ZESP = 60;

4.

UPDATE PRACOWNICY SET ID_ZESP = (SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA = 'BAZY DANYCH')
WHERE ID_PRAC = 250 OR ID_PRAC = 260 OR ID_PRAC = 270;

SELECT * FROM PRACOWNICY WHERE ID_ZESP = 60;

5.

UPDATE PRACOWNICY SET ID_SZEFA = (SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO = 'MORZY')
WHERE ID_ZESP = (SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA = 'BAZY DANYCH');

SELECT * FROM PRACOWNICY WHERE ID_SZEFA = (SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO = 'MORZY') ORDER BY ID_PRAC;

6.

DELETE FROM ZESPOLY
WHERE NAZWA = 'BAZY DANYCH';

Polecenie nie zakonczylo sie sukcesem z tego powodu, ze sa osoby przypisane do tego zespolu.

7.

DELETE FROM PRACOWNICY
WHERE ID_ZESP = (SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA = 'BAZY DANYCH');

DELETE FROM ZESPOLY
WHERE NAZWA = 'BAZY DANYCH';

SELECT *
FROM ZESPOLY;

SELECT *
FROM PRACOWNICY;

8.

SELECT P.NAZWISKO, P.PLACA_POD, 0.1 * (SELECT AVG(PLACA_POD) FROM PRACOWNICY WHERE P.ID_ZESP = ID_ZESP GROUP BY ID_ZESP)
AS PODWYZKA FROM PRACOWNICY P ORDER BY NAZWISKO;

9.
UPDATE
(SELECT P.NAZWISKO, P.PLACA_POD, 0.1 * (SELECT AVG(PLACA_POD) FROM PRACOWNICY WHERE P.ID_ZESP = ID_ZESP GROUP BY ID_ZESP)
AS PODWYZKA FROM PRACOWNICY P ORDER BY NAZWISKO)
SET PLACA_POD = PLACA_POD + PODWYZKA

SELECT NAZWISKO, PLACA_POD FROM PRACOWNICY ORDER BY NAZWISKO;

10.

SELECT * FROM PRACOWNICY WHERE PLACA_POD = (SELECT MIN(PLACA_POD) FROM PRACOWNICY);

11.
UPDATE
(SELECT * FROM PRACOWNICY WHERE PLACA_POD = (SELECT MIN(PLACA_POD) FROM PRACOWNICY))
SET PLACA_POD = ROUND((SELECT AVG(PLACA_POD) FROM PRACOWNICY), 2);

SELECT * FROM PRACOWNICY
WHERE NAZWISKO = 'ZAKRZEWICZ'

12.

UPDATE PRACOWNICY
SET PLACA_DOD = (SELECT AVG(PLACA_POD) FROM PRACOWNICY WHERE ID_SZEFA = (SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO = 'MORZY'))
WHERE ID_ZESP = 20;

SELECT NAZWISKO, PLACA_DOD FROM PRACOWNICY WHERE ID_ZESP = 20;

13.

SELECT NAZWISKO, PLACA_POD FROM PRACOWNICY, ZESPOLY WHERE PRACOWNICY.ID_ZESP = ZESPOLY.ID_ZESP AND ZESPOLY.NAZWA = 'SYSTEMY ROZPROSZONE';

UPDATE (SELECT * FROM PRACOWNICY, ZESPOLY WHERE PRACOWNICY.ID_ZESP = ZESPOLY.ID_ZESP AND ZESPOLY.NAZWA = 'SYSTEMY ROZPROSZONE')
SET PLACA_POD = PLACA_POD * 1.25;

SELECT NAZWISKO, PLACA_POD FROM PRACOWNICY, ZESPOLY WHERE PRACOWNICY.ID_ZESP = ZESPOLY.ID_ZESP AND ZESPOLY.NAZWA = 'SYSTEMY ROZPROSZONE' ORDER BY NAZWISKO;

14.

SELECT P.NAZWISKO AS PRACOWNIK, S.NAZWISKO AS SZEF FROM PRACOWNICY P
INNER JOIN PRACOWNICY S ON P.ID_SZEFA = S.ID_PRAC
WHERE P.ID_SZEFA = (SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO = 'MORZY');

DELETE FROM
(SELECT P.NAZWISKO AS PRACOWNIK, S.NAZWISKO AS SZEF FROM PRACOWNICY P
JOIN PRACOWNICY S ON P.ID_SZEFA = S.ID_PRAC)
WHERE SZEF = 'MORZY'

SELECT P.NAZWISKO AS PRACOWNIK, S.NAZWISKO AS SZEF FROM PRACOWNICY P
INNER JOIN PRACOWNICY S ON P.ID_SZEFA = S.ID_PRAC
WHERE P.ID_SZEFA = (SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO = 'MORZY');

15.
SELECT * FROM PRACOWNICY
ORDER BY NAZWISKO;

16.
CREATE SEQUENCE PRAC_SEQ START WITH 300 INCREMENT BY 10;

17.
INSERT INTO PRACOWNICY (ID_PRAC, NAZWISKO, ETAT, PLACA_POD)
VALUES (PRAC_SEQ.NEXTVAL, 'Trąbczyński', 'STAZYSTA', 1000);

select *
from PRACOWNICY;

18.
UPDATE PRACOWNICY
SET PLACA_DOD = PRAC_SEQ.CURRVAL
WHERE NAZWISKO = 'Trąbczyński';

select *
from PRACOWNICY;

19.
DELETE FROM PRACOWNICY
WHERE NAZWISKO = 'Trąbczyński';

20.
CREATE SEQUENCE MALA_SEQ MAXVALUE 10;
SELECT MALA_SEQ.nextval FROM DUAL;

21.
DROP SEQUENCE MALA_SEQ;