1.

SELECT Z.ID_ZESP, Z.NAZWA, Z.ADRES FROM ZESPOLY Z
WHERE NOT EXISTS (SELECT * FROM PRACOWNICY P WHERE P.ID_ZESP = Z.ID_ZESP);

2.

SELECT P.NAZWISKO, P.PLACA_POD, P.ETAT FROM PRACOWNICY P
WHERE P.PLACA_POD > (SELECT AVG(S.PLACA_POD) FROM PRACOWNICY S
GROUP BY ETAT HAVING S.ETAT = P.ETAT)
ORDER BY P.PLACA_POD DESC;

3.

SELECT P.NAZWISKO, P.PLACA_POD FROM PRACOWNICY P
WHERE P.PLACA_POD > (SELECT 0.75*S.PLACA_POD FROM PRACOWNICY S
WHERE P.ID_SZEFA = S.ID_PRAC)
ORDER BY NAZWISKO;

4.

SELECT P.NAZWISKO FROM PRACOWNICY P
WHERE P.ETAT = 'PROFESOR' AND NOT EXISTS
(SELECT * FROM PRACOWNICY S WHERE S.ETAT = 'STAZYSTA'
AND P.ID_PRAC = S.ID_SZEFA);

5.

SELECT NAZWA, MAKS_SUMA_PLAC FROM (SELECT MAX(X) AS MAKS_SUMA_PLAC FROM (SELECT SUM(PLACA_POD) AS X FROM PRACOWNICY GROUP BY ID_ZESP))T
LEFT OUTER JOIN (SELECT ID_ZESP, SUM(PLACA_POD) AS SUMA FROM PRACOWNICY GROUP BY ID_ZESP) T1
ON T.MAKS_SUMA_PLAC = T1.SUMA LEFT OUTER JOIN ZESPOLY Z ON Z.ID_ZESP = T1.ID_ZESP

6.

SELECT P.NAZWISKO, P.PLACA_POD
FROM PRACOWNICY P
WHERE 3 > (
SELECT COUNT(*)
FROM PRACOWNICY S
WHERE S.PLACA_POD > P.PLACA_POD
);

7.

SELECT P.NAZWISKO, P.PLACA_POD, P.PLACA_POD - (SELECT AVG(S.PLACA_POD)
FROM PRACOWNICY S
WHERE P.ID_ZESP = S.ID_ZESP
) AS RÓŻNICA
FROM PRACOWNICY P
ORDER BY P.NAZWISKO;

SELECT P.NAZWISKO, P.PLACA_POD, (P.PLACA_POD - Av.AVG_SALARY) AS RÓŻNICA
FROM PRACOWNICY P INNER JOIN (SELECT ID_ZESP, AVG(PLACA_POD) AS AVG_SALARY FROM PRACOWNICY
GROUP BY ID_ZESP) Av ON P.ID_ZESP = Av.ID_ZESP
ORDER BY P.NAZWISKO; 

8.
SELECT P.NAZWISKO, P.PLACA_POD, P.PLACA_POD - (SELECT AVG(S.PLACA_POD)
FROM PRACOWNICY S
WHERE P.ID_ZESP = S.ID_ZESP
) AS RÓŻNICA
FROM PRACOWNICY P
WHERE P.PLACA_POD - (SELECT AVG(S.PLACA_POD)
FROM PRACOWNICY S
WHERE P.ID_ZESP = S.ID_ZESP
) > 0
ORDER BY P.NAZWISKO;

SELECT P.NAZWISKO, P.PLACA_POD, (P.PLACA_POD - Av.AVG_SALARY) AS RÓŻNICA
FROM PRACOWNICY P INNER JOIN (SELECT ID_ZESP, AVG(PLACA_POD) AS AVG_SALARY FROM PRACOWNICY
GROUP BY ID_ZESP) Av ON P.ID_ZESP = Av.ID_ZESP
WHERE p.PLACA_POD > Av.avg_salary
ORDER BY P.NAZWISKO; 

9.
SELECT NAZWISKO, (SELECT COUNT(*)
FROM PRACOWNICY P
WHERE P.ID_SZEFA = S.ID_PRAC) AS PODWLADNI
FROM PRACOWNICY S
INNER JOIN ZESPOLY Z ON S.ID_ZESP = Z.ID_ZESP
WHERE S.ETAT = 'PROFESOR' AND Z.ADRES LIKE '%PIOTROWO%'
ORDER BY PODWLADNI DESC;

10.
SELECT ZESPOLY.NAZWA, AVG(PRACOWNICY.PLACA_POD) AS SREDNIA_W_ZESPOLE,
(SELECT ROUND(AVG(PLACA_POD), 2)
FROM PRACOWNICY) AS SREDNIA_OGOLNA,
CASE WHEN AVG(PRACOWNICY.PLACA_POD) >= (SELECT AVG(PLACA_POD) FROM PRACOWNICY) THEN ':)' 
WHEN AVG(PRACOWNICY.PLACA_POD) < (SELECT AVG(PLACA_POD) FROM PRACOWNICY) THEN ':(' 
ELSE '???' END AS NASTROJE
FROM ZESPOLY LEFT JOIN PRACOWNICY ON ZESPOLY.ID_ZESP = PRACOWNICY.ID_ZESP
GROUP BY ZESPOLY.NAZWA
ORDER BY ZESPOLY.NAZWA;

11.
SELECT * FROM ETATY
ORDER BY(
SELECT COUNT(*)
FROM PRACOWNICY
WHERE ETAT = ETATY.NAZWA) DESC, ETATY.NAZWA;